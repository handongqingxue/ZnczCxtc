<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.znczCxtc.dao.ExportExcelMapper">
	<select id="queryDDZHCXList" resultType="com.znczCxtc.entity.DingDan">
		select dd.*,ddzt.mc ddztMc,bdjl.mz,bdjl.pz,bdjl.jz,dfgbjl.dfgbmz,dfgbjl.dfgbpz,dfgbjl.dfgbjz,cl.cph cyclCph,wzlx.mc wzlxMc,wz.mc wzMc,yss.mc yssMc,fhdw.mc fhdwMc,shdw.mc shdwMc,sj.xm cysjXm,sj.sfzh cysjSfzh,cltz.jcsj,cltz.ccsj from ding_dan dd
		 left join ding_dan_zhuang_tai ddzt on dd.ddztId=ddzt.id left join bang_dan_ji_lu bdjl on bdjl.ddId=dd.id left join dui_fang_guo_bang_ji_lu dfgbjl on dfgbjl.ddId=dd.id left join che_liang cl on dd.cyclId=cl.id
		 left join che_liang_tai_zhang cltz on cltz.ddId=dd.id left join wu_zi_lei_xing wzlx on dd.wzlxId=wzlx.id left join wu_zi wz on dd.wzId=wz.id
		 left join yun_shu_shang yss on dd.yssId=yss.id left join fa_huo_dan_wei fhdw on dd.fhdwId=fhdw.id
		 left join shou_huo_dan_wei shdw on dd.shdwId=shdw.id left join si_ji sj on dd.cysjId=sj.id where 1=1
		<if test="ddh!=''&amp;ddh!=null">
			and dd.ddh like CONCAT('%',#{ddh},'%')
		</if>
		<if test="ddztId!=''&amp;ddztId!=null">
			and dd.ddztId=#{ddztId}
		</if>
		<if test="ddztMc!=''&amp;ddztMc!=null">
			and ddzt.mc=#{ddztMc}
		</if>
		<if test="cyclCph!=''&amp;cyclCph!=null">
			and cl.cph like CONCAT('%',#{cyclCph},'%')
		</if>
		<if test="jhysrq!=''&amp;jhysrq!=null">
			and dd.jhysrq like CONCAT('%',#{jhysrq},'%')
		</if>
		<if test="yssMc!=''&amp;yssMc!=null">
			and yss.mc like CONCAT('%',#{yssMc},'%')
		</if>
		<if test="wzMc!=''&amp;wzMc!=null">
			and wz.mc like CONCAT('%',#{wzMc},'%')
		</if>
		<if test="fhdwMc!=''&amp;fhdwMc!=null">
			and fhdw.mc like CONCAT('%',#{fhdwMc},'%')
		</if>
		<if test="shdwMc!=''&amp;shdwMc!=null">
			and shdw.mc like CONCAT('%',#{shdwMc},'%')
		</if>
		<if test="cysjXm!=''&amp;cysjXm!=null">
			and sj.xm like CONCAT('%',#{cysjXm},'%')
		</if>
		<if test="cysjSfzh!=''&amp;cysjSfzh!=null">
			and sj.sfzh like CONCAT('%',#{cysjSfzh},'%')
		</if>
		<if test="jcsjs!=''&amp;jcsjs!=null&amp;jcsje!=''&amp;jcsje!=null">
			and cltz.jcsj between #{jcsjs} and #{jcsje}
		</if>
		<if test="ccsjs!=''&amp;ccsjs!=null&amp;ccsje!=''&amp;ccsje!=null">
			and cltz.ccsj between #{ccsjs} and #{ccsje}
		</if>
		order by dd.bjsj desc
		<if test="dcfw==@com.znczCxtc.util.Constant@DANG_QIAN_YE">
			limit #{rowNum},#{rows}
		</if>
	</select>
	<select id="queryDDSHJLList" resultType="com.znczCxtc.entity.DingDanShenHeJiLu">
		select ddshjl.*,dd.ddh,sj.xm sjXm,sj.sfzh sjSfzh,cl.cph cyclCph,dd.lxlx,dd.yzxzl,dd.sjzl,dd.zlceb,wz.mc wzMc,yss.mc yssMc,fhdw.mc fhdwMc,shdw.mc shdwMc,shr.yhm shrYhm from ding_dan_shen_he_ji_lu ddshjl left join ding_dan dd on ddshjl.ddId=dd.id
		 left join che_liang cl on dd.cyclId=cl.id left join si_ji sj on dd.cysjId=sj.id left join wu_zi wz on dd.wzId=wz.id left join yun_shu_shang yss on dd.yssId=yss.id left join fa_huo_dan_wei fhdw on dd.fhdwId=fhdw.id
		 left join shou_huo_dan_wei shdw on dd.shdwId=shdw.id left join yong_hu shr on ddshjl.shrId=shr.id where 1=1
		<if test="ddh!=''&amp;ddh!=null">
			and dd.ddh like CONCAT('%',#{ddh},'%')
		</if>
		<if test="shlx!=''&amp;shlx!=null">
			and ddshjl.shlx=#{shlx}
		</if>
		<if test="shsjks!=''&amp;shsjks!=null&amp;shsjjs!=''&amp;shsjjs!=null">
			and ddshjl.shsj between #{shsjks} and #{shsjjs}
		</if>
		<if test="cyclCph!=''&amp;cyclCph!=null">
			and cl.cph like CONCAT('%',#{cyclCph},'%')
		</if>
		<if test="shrYhm!=''&amp;shrYhm!=null">
			and shr.yhm like CONCAT('%',#{shrYhm},'%')
		</if>
		<if test="yssMc!=''&amp;yssMc!=null">
			and yss.mc like CONCAT('%',#{yssMc},'%')
		</if>
		<if test="wzMc!=''&amp;wzMc!=null">
			and wz.mc like CONCAT('%',#{wzMc},'%')
		</if>
		<if test="fhdwMc!=''&amp;fhdwMc!=null">
			and fhdw.mc like CONCAT('%',#{fhdwMc},'%')
		</if>
		<if test="shdwMc!=''&amp;shdwMc!=null">
			and shdw.mc like CONCAT('%',#{shdwMc},'%')
		</if>
		<if test="sjXm!=''&amp;sjXm!=null">
			and sj.xm like CONCAT('%',#{sjXm},'%')
		</if>
		<if test="sjSfzh!=''&amp;sjSfzh!=null">
			and sj.sfzh like CONCAT('%',#{sjSfzh},'%')
		</if>
		order by ddshjl.shsj desc
		<if test="dcfw==@com.znczCxtc.util.Constant@DANG_QIAN_YE">
			limit #{rowNum},#{rows}
		</if>
	</select>
	<select id="queryBDJLList" resultType="com.znczCxtc.entity.BangDanJiLu">
		select bdjl.id,bdjl.rq,sj.xm cysjXm,dd.id ddId,dd.ddh,ddzt.mc ddztMc,wz.mc wzMc,cltz.jcsj,cltz.ccsj,bdjl.mz,dfgbjl.dfgbmz,fhdw.mc fhdwMc,bdjl.pz,dfgbjl.dfgbpz,shdw.mc shdwMc,bdjl.jz,dfgbjl.dfgbjz,yss.mc yssMc,cl.cph cyclCph,bdjl.bz from bang_dan_ji_lu bdjl
		 left join ding_dan dd on bdjl.ddId=dd.id left join ding_dan_zhuang_tai ddzt on dd.ddztId=ddzt.id left join dui_fang_guo_bang_ji_lu dfgbjl on dfgbjl.ddId=dd.id
		  left join wu_zi wz on dd.wzId=wz.id left join fa_huo_dan_wei fhdw on dd.fhdwId=fhdw.id left join shou_huo_dan_wei shdw on dd.shdwId=shdw.id
		  left join yun_shu_shang yss on dd.yssId=yss.id left join si_ji sj on dd.cysjId=sj.id left join che_liang cl on dd.cyclId=cl.id left join che_liang_tai_zhang cltz on cltz.ddId=dd.id where 1=1
		<if test="ddh!=''&amp;ddh!=null">
			and dd.ddh like CONCAT('%',#{ddh},'%')
		</if>
		order by bdjl.rq desc
		<if test="dcfw==@com.znczCxtc.util.Constant@DANG_QIAN_YE">
			limit #{rowNum},#{rows}
		</if>
	</select>
	<select id="queryGBJLList" resultType="com.znczCxtc.entity.GuoBangJiLu">
		select gbjl.*,dd.ddh,cl.cph cyclCph from guo_bang_ji_lu gbjl,ding_dan dd,che_liang cl where gbjl.ddId=dd.id and dd.cyclId=cl.id
		<if test="ddh!=''&amp;ddh!=null">
			and dd.ddh like CONCAT('%',#{ddh},'%')
		</if>
		<if test="cyclCph!=''&amp;cyclCph!=null">
			and dd.cph like CONCAT('%',#{cyclCph},'%')
		</if>
		<if test="gbsjks!=''&amp;gbsjks!=null&amp;gbsjjs!=''&amp;gbsjjs!=null">
			and gbjl.gbsj between #{gbsjks} and #{gbsjjs}
		</if>
		order by gbjl.gbsj desc
		<if test="dcfw==@com.znczCxtc.util.Constant@DANG_QIAN_YE">
			limit #{rowNum},#{rows}
		</if>
	</select>
</mapper>